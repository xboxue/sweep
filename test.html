<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zoid/9.0.87/zoid.min.js"></script>
    <script>
      const offeringsWidget = zoid.create({
        tag: "offerings-widget",
        url: "http://localhost:3000/widget",
        dimensions: {
          width: "100%",
          height: "100%",
        },
        autoResize: {
          height: true,
          width: false,
        },
        props: {
          onCheckout: {
            type: "function",
            required: true,
          },
          businessId: {
            type: "number",
            required: true,
          },
        },
      });

      const checkoutWidget = zoid.create({
        tag: "checkout-widget",
        url: "http://localhost:3000/widget/checkout",
        dimensions: {
          width: "100%",
          height: "100%",
        },
        containerTemplate: ({
          doc,
          uid,
          frame,
          prerenderFrame,
          dimensions,
        }) => {
          const container = doc.createElement("div");
          container.id = uid;
          container.appendChild(frame);
          frame.style.width = dimensions.width;
          frame.style.height = dimensions.height;
          container.appendChild(prerenderFrame);
          container.style.cssText =
            "position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 2147483647;";
          return container;
        },
        props: {
          onClose: {
            type: "function",
            required: true,
          },
          open: {
            type: "boolean",
            required: true,
          },
          businessId: {
            type: "number",
            required: true,
          },
        },
      });

      const checkoutWidgetInstance = checkoutWidget({
        onClose: () => {
          document.querySelector("#checkout-widget").style.display = "none";
          document.body.style.removeProperty("padding-right");
          document.body.style.removeProperty("overflow");
          checkoutWidgetInstance.updateProps({ open: false });
        },
        open: false,
        businessId: 1,
      });
      checkoutWidgetInstance.render("#checkout-widget");

      offeringsWidget({
        onCheckout: () => {
          document.querySelector("#checkout-widget").style.display = "block";
          document.body.style.paddingRight = `${
            window.innerWidth - document.documentElement.clientWidth
          }px`;
          document.body.style.overflow = "hidden";
          checkoutWidgetInstance.updateProps({ open: true });
        },
        businessId: 1,
      }).render("#offerings-widget");
    </script>
    <div id="offerings-widget" style="width: 100%; min-height: 800px"></div>
    <div id="checkout-widget" style="display: none"></div>
  </body>
</html>
